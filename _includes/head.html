<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

{% seo %}

{% feed_meta %}

{% if jekyll.environment == 'production' and site.google_analytics %}
  {% include google-analytics.html %}
{% endif %}

{% if page.math %}
  {% include mathjax.html %}
{% endif %}

<!-- Fonts -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&display=swap">

<link rel="stylesheet" href="{{ '/assets/css/main.css' | relative_url }}">
<link id="site-skin" rel="stylesheet" href="{{ '/assets/css/skin-mono-light.css' | relative_url }}">

<script>
  const siteSkin = {
    storageKey: "site-skin",
    light: "{{ '/assets/css/skin-mono-light.css' | relative_url }}",
    dark: "{{ '/assets/css/skin-mono-dark.css' | relative_url }}"
  };

  function applySkin(mode) {
    const link = document.getElementById("site-skin");
    if (!link) {
      return;
    }
    const href = mode === "dark" ? siteSkin.dark : siteSkin.light;
    link.setAttribute("href", href);
    document.documentElement.setAttribute("data-theme", mode);

    // Sync toggle switch state
    const toggle = document.getElementById("theme-switch");
    if (toggle) {
      toggle.checked = mode === "dark";
    }
  }

  function preferredSkin() {
    const stored = localStorage.getItem(siteSkin.storageKey);
    if (stored === "light" || stored === "dark") {
      return stored;
    }
    return window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches
      ? "dark"
      : "light";
  }

  window.toggleTheme = function () {
    const current = document.documentElement.getAttribute("data-theme") || preferredSkin();
    const next = current === "dark" ? "light" : "dark";
    localStorage.setItem(siteSkin.storageKey, next);
    applySkin(next);
  };

  applySkin(preferredSkin());

  // Sync toggle state after DOM is ready
  document.addEventListener("DOMContentLoaded", function() {
    const toggle = document.getElementById("theme-switch");
    if (toggle) {
      toggle.checked = preferredSkin() === "dark";
    }
  });
</script>

<script async src="https://use.fontawesome.com/releases/v5.0.12/js/all.js"></script>

{% include custom-head.html %}
